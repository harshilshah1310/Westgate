webpackJsonp([79],{1973:function(t,e,r){"use strict";function i(t){return c._57(0,[(t()(),c._31(0,0,null,null,6,"button",[["aria-haspopup","true"],["icon-only",""],["ion-button",""]],[[1,"aria-label",0]],[[null,"click"]],function(t,e,r){var i=!0;if("click"===e){i=!1!==t.component.openToc(r)&&i}return i},H.b,H.a)),c._30(1,1097728,[[1,4]],0,X.a,[[8,""],V.a,c.t,c.V],null,null),c._47(131072,F.a,[k.a,c.j]),(t()(),c._55(-1,0,["\n                "])),(t()(),c._31(4,0,null,0,1,"ion-icon",[["name","bookmark"],["role","img"]],[[2,"hide",null]],null,null,null,null)),c._30(5,147456,null,0,z.a,[V.a,c.t,c.V],{name:[0,"name"]},null),(t()(),c._55(-1,0,["\n            "]))],function(t,e){t(e,5,0,"bookmark")},function(t,e){t(e,0,0,c._56(e,0,0,c._44(e,2).transform("addon.mod_scorm.toc")));t(e,4,0,c._44(e,5)._hidden)})}function o(t){return c._57(0,[(t()(),c._31(0,0,null,null,1,"ion-spinner",[],[[2,"spinner-paused",null]],null,null,B.b,B.a)),c._30(1,114688,null,0,W.a,[V.a,c.t,c.V],null,null)],function(t,e){t(e,1,0)},function(t,e){t(e,0,0,c._44(e,1)._paused)})}function s(t){return c._57(0,[(t()(),c._31(0,0,null,null,1,"core-iframe",[],null,null,null,K.b,K.a)),c._30(1,638976,null,0,J.a,[q.a,Y.a,p.a,Q.c],{src:[0,"src"],iframeWidth:[1,"iframeWidth"],iframeHeight:[2,"iframeHeight"]},null)],function(t,e){var r=e.component;t(e,1,0,r.src,r.scorm.popup?r.scorm.width:void 0,r.scorm.popup?r.scorm.height:void 0)},null)}function n(t){return c._57(0,[(t()(),c._31(0,0,null,null,2,"p",[],null,null,null,null,null)),(t()(),c._55(1,null,["",""])),c._47(131072,F.a,[k.a,c.j])],null,function(t,e){var r=e.component;t(e,1,0,c._56(e,1,0,c._44(e,2).transform(r.errorMessage)))})}function a(t){return c._57(0,[(t()(),c._31(0,0,null,null,23,"ion-header",[],null,null,null,null,null)),c._30(1,16384,null,0,Z.a,[V.a,c.t,c.V,[2,tt.a]],null,null),(t()(),c._55(-1,null,["\n    "])),(t()(),c._31(3,0,null,null,19,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,et.b,et.a)),c._30(4,49152,null,0,rt.a,[it.a,[2,tt.a],[2,ot.a],V.a,c.t,c.V],null,null),c._30(5,212992,null,0,st.a,[rt.a,nt.a,k.a,m.a],null,null),(t()(),c._55(-1,3,["\n        "])),(t()(),c._31(7,0,null,3,3,"ion-title",[],null,null,null,at.b,at.a)),c._30(8,49152,null,0,ct.a,[V.a,c.t,c.V,[2,lt.a],[2,rt.a]],null,null),(t()(),c._31(9,0,null,0,1,"core-format-text",[],null,null,null,null,null)),c._30(10,540672,null,0,dt.a,[c.t,f.a,p.a,ht.a,k.a,nt.a,ut.a,mt.a,q.a,ft.a,_t.a,pt.a,[2,ot.a],[2,vt.a],[2,It.a],Y.a,m.a],{text:[0,"text"]},null),(t()(),c._55(-1,3,["\n\n        "])),(t()(),c._31(12,0,null,2,9,"ion-buttons",[["end",""]],null,null,null,null,null)),c._30(13,16384,null,1,Et.a,[V.a,c.t,c.V,[2,lt.a],[2,rt.a]],null,null),c._52(603979776,1,{_buttons:1}),(t()(),c._55(-1,null,["\n            "])),(t()(),c._26(16777216,null,null,1,null,i)),c._30(17,16384,null,0,Ct.k,[c._11,c._6],{ngIf:[0,"ngIf"]},null),(t()(),c._55(-1,null,["\n            "])),(t()(),c._26(16777216,null,null,1,null,o)),c._30(20,16384,null,0,Ct.k,[c._11,c._6],{ngIf:[0,"ngIf"]},null),(t()(),c._55(-1,null,["\n        "])),(t()(),c._55(-1,3,["\n    "])),(t()(),c._55(-1,null,["\n"])),(t()(),c._55(-1,null,["\n"])),(t()(),c._31(25,0,null,null,15,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,gt.b,gt.a)),c._30(26,4374528,null,0,vt.a,[V.a,nt.a,Mt.a,c.t,c.V,it.a,wt.a,c.M,[2,tt.a],[2,ot.a]],null,null),(t()(),c._55(-1,1,["\n    "])),(t()(),c._31(28,0,null,1,11,"core-loading",[],null,null,null,Nt.b,Nt.a)),c._30(29,638976,null,0,Tt.a,[k.a,c.t,m.a,ut.a],{hideUntil:[0,"hideUntil"]},null),(t()(),c._55(-1,0,["\n        "])),(t()(),c._31(31,0,null,0,1,"core-navigation-bar",[],null,[[null,"action"]],function(t,e,r){var i=!0;if("action"===e){i=!1!==t.component.loadSco(r)&&i}return i},Dt.b,Dt.a)),c._30(32,49152,null,0,St.a,[ht.a],{previous:[0,"previous"],next:[1,"next"]},{action:"action"}),(t()(),c._55(-1,0,["\n        "])),(t()(),c._26(16777216,null,0,1,null,s)),c._30(35,16384,null,0,Ct.k,[c._11,c._6],{ngIf:[0,"ngIf"]},null),(t()(),c._55(-1,0,["\n        "])),(t()(),c._26(16777216,null,0,1,null,n)),c._30(38,16384,null,0,Ct.k,[c._11,c._6],{ngIf:[0,"ngIf"]},null),(t()(),c._55(-1,0,["\n    "])),(t()(),c._55(-1,1,["\n"])),(t()(),c._55(-1,null,["\n"]))],function(t,e){var r=e.component;t(e,5,0);t(e,10,0,r.title);t(e,17,0,r.showToc&&!r.loadingToc&&r.toc&&r.toc.length);t(e,20,0,r.showToc&&r.loadingToc);t(e,29,0,r.loaded);t(e,32,0,r.previousSco,r.nextSco);t(e,35,0,r.loaded&&r.src);t(e,38,0,!r.src&&r.errorMessage)},function(t,e){t(e,3,0,c._44(e,4)._hidden,c._44(e,4)._sbPadding);t(e,25,0,c._44(e,26).statusbarPadding,c._44(e,26)._hasRefresher)})}Object.defineProperty(e,"__esModule",{value:!0});var c=r(0),l=r(8),d=r(3),h=r(24),u=r(29),m=r(12),f=r(1),_=r(78),p=r(4),v=r(23),I=r(680),E=r(214),C=r(365),g=r(297),M=function(){function t(t,e,r,i,o,s,n,a,c){this.eventsProvider=t,this.scormProvider=e,this.siteId=r,this.scorm=i,this.scoId=o,this.attempt=s,this.mode=a,this.offline=c,this.CMI_STRING_256="^[\\u0000-\\uFFFF]{0,255}$",this.CMI_STRING_4096="^[\\u0000-\\uFFFF]{0,4096}$",this.CMI_TIME="^([0-2]{1}[0-9]{1}):([0-5]{1}[0-9]{1}):([0-5]{1}[0-9]{1})(.[0-9]{1,2})?$",this.CMI_TIMESPAN="^([0-9]{2,4}):([0-9]{2}):([0-9]{2})(.[0-9]{1,2})?$",this.CMI_INTEGER="^\\d+$",this.CMI_SINTEGER="^-?([0-9]+)$",this.CMI_DECIMAL="^-?([0-9]{0,3})(.[0-9]*)?$",this.CMI_IDENTIFIER="^[\\u0021-\\u007E]{0,255}$",this.CMI_FEEDBACK=this.CMI_STRING_256,this.CMI_INDEX="[._](\\d+).",this.CMI_STATUS="^passed$|^completed$|^failed$|^incomplete$|^browsed$",this.CMI_STATUS_2="^passed$|^completed$|^failed$|^incomplete$|^browsed$|^not attempted$",this.CMI_EXIT="^time-out$|^suspend$|^logout$|^$",this.CMI_TYPE="^true-false$|^choice$|^fill-in$|^matching$|^performance$|^sequencing$|^likert$|^numeric$",this.CMI_RESULT="^correct$|^wrong$|^unanticipated$|^neutral$|^([0-9]{0,3})?(.[0-9]*)?$",this.NAV_EVENT="^previous$|^continue$",this.CMI_CHILDREN="core,suspend_data,launch_data,comments,objectives,student_data,student_preference,interactions",this.CORE_CHILDREN="student_id,student_name,lesson_location,credit,lesson_status,entry,score,total_time,lesson_mode,exit,session_time",this.SCORE_CHILDREN="raw,min,max",this.COMMENTS_CHILDREN="content,location,time",this.OBJECTIVES_CHILDREN="id,score,status",this.CORRECT_RESPONSES_CHILDREN="pattern",this.STUDENT_DATA_CHILDREN="mastery_score,max_time_allowed,time_limit_action",this.STUDENT_PREFERENCE_CHILDREN="audio,language,speed,text",this.INTERACTIONS_CHILDREN="id,objectives,time,type,correct_responses,weighting,student_response,result,latency",this.SCORE_RANGE="0#100",this.AUDIO_RANGE="-1#100",this.SPEED_RANGE="-100#100",this.WEIGHTING_RANGE="-100#100",this.TEXT_RANGE="-1#1",this.ERROR_STRINGS={0:"No error",101:"General exception",201:"Invalid argument error",202:"Element cannot have children",203:"Element not an array - cannot have count",301:"Not initialized",401:"Not implemented error",402:"Invalid set value, element is a keyword",403:"Element is read only",404:"Element is write only",405:"Incorrect data type"},this.currentUserData={},this.def={},this.defExtra={},this.dataModel={},this.initialized=!1,this.mode=a||E.a.MODENORMAL,this.offline=!!c,this.init(n)}return t.prototype.addTime=function(t,e){var r=t.split(":"),i=e.split(":"),o=r[2].split("."),s=i[2].split("."),n=0,a=0;o.length>1&&(a=parseInt(o[1],10));var c=0;s.length>1&&(c=parseInt(s[1],10));var l=a+c;l-=100*(n=Math.floor(l/100)),Math.floor(l)<10&&(l="0"+l.toString());var d=parseInt(o[0],10)+parseInt(s[0],10)+n;d-=60*(n=Math.floor(d/60)),Math.floor(d)<10&&(d="0"+d.toString());var h=parseInt(r[1],10)+parseInt(i[1],10)+n;(h-=60*(n=Math.floor(h/60)))<10&&(h="0"+h.toString());var u=parseInt(r[0],10)+parseInt(i[0],10)+n;return u<10&&(u="0"+u.toString()),"0"!=l?u+":"+h+":"+d+"."+l:u+":"+h+":"+d},t.prototype.cloneObj=function(t){if(null==t||"object"!=typeof t)return t;var e=new t.constructor;for(var r in t)e[r]=this.cloneObj(t[r]);return e},t.prototype.collectData=function(){var t=[];for(var e in this.currentUserData[this.scoId])if("cmi"==e.substr(0,3)){var r=new RegExp(this.CMI_INDEX,"g"),i=String(e).replace(r,".n.");if("cmi.core.session_time"!=e&&(void 0===this.dataModel[this.scoId][e]&&void 0!==this.dataModel[this.scoId][i]&&(this.dataModel[this.scoId][e]=this.cloneObj(this.dataModel[this.scoId][i])),void 0!==this.dataModel[this.scoId][e]&&"r"!=this.dataModel[this.scoId][e].mod)){var o={element:e.replace(r,"_$1."),value:this.getEl(e)};void 0!==this.dataModel[this.scoId][e].defaultvalue?this.dataModel[this.scoId][e].defaultvalue==o.value&&typeof this.dataModel[this.scoId][e].defaultvalue==typeof o.value||(t.push(o),this.dataModel[this.scoId][e].defaultvalue=o.value):(t.push(o),this.dataModel[this.scoId][e].defaultvalue=o.value)}}return t},t.prototype.getEl=function(t){return void 0!==this.currentUserData[this.scoId]&&void 0!==this.currentUserData[this.scoId][t]?this.currentUserData[this.scoId][t]:""},t.prototype.init=function(t){for(var e in t){var r=t[e];this.def[e]=r.defaultdata,this.defExtra[e]=r.userdata}for(var e in this.def){this.dataModel[e]={"cmi._children":{defaultvalue:this.CMI_CHILDREN,mod:"r",writeerror:"402"},"cmi._version":{defaultvalue:"3.4",mod:"r",writeerror:"402"},"cmi.core._children":{defaultvalue:this.CORE_CHILDREN,mod:"r",writeerror:"402"},"cmi.core.student_id":{defaultvalue:this.def[e]["cmi.core.student_id"],mod:"r",writeerror:"403"},"cmi.core.student_name":{defaultvalue:this.def[e]["cmi.core.student_name"],mod:"r",writeerror:"403"},"cmi.core.lesson_location":{defaultvalue:this.def[e]["cmi.core.lesson_location"],format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.core.credit":{defaultvalue:this.def[e]["cmi.core.credit"],mod:"r",writeerror:"403"},"cmi.core.lesson_status":{defaultvalue:this.def[e]["cmi.core.lesson_status"],format:this.CMI_STATUS,mod:"rw",writeerror:"405"},"cmi.core.entry":{defaultvalue:this.def[e]["cmi.core.entry"],mod:"r",writeerror:"403"},"cmi.core.score._children":{defaultvalue:this.SCORE_CHILDREN,mod:"r",writeerror:"402"},"cmi.core.score.raw":{defaultvalue:this.def[e]["cmi.core.score.raw"],format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.core.score.max":{defaultvalue:this.def[e]["cmi.core.score.max"],format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.core.score.min":{defaultvalue:this.def[e]["cmi.core.score.min"],format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.core.total_time":{defaultvalue:this.def[e]["cmi.core.total_time"],mod:"r",writeerror:"403"},"cmi.core.lesson_mode":{defaultvalue:this.def[e]["cmi.core.lesson_mode"],mod:"r",writeerror:"403"},"cmi.core.exit":{defaultvalue:this.def[e]["cmi.core.exit"],format:this.CMI_EXIT,mod:"w",readerror:"404",writeerror:"405"},"cmi.core.session_time":{format:this.CMI_TIMESPAN,mod:"w",defaultvalue:"00:00:00",readerror:"404",writeerror:"405"},"cmi.suspend_data":{defaultvalue:this.def[e]["cmi.suspend_data"],format:this.CMI_STRING_4096,mod:"rw",writeerror:"405"},"cmi.launch_data":{defaultvalue:this.def[e]["cmi.launch_data"],mod:"r",writeerror:"403"},"cmi.comments":{defaultvalue:this.def[e]["cmi.comments"],format:this.CMI_STRING_4096,mod:"rw",writeerror:"405"},"cmi.evaluation.comments._count":{defaultvalue:"0",mod:"r",writeerror:"402"},"cmi.evaluation.comments._children":{defaultvalue:this.COMMENTS_CHILDREN,mod:"r",writeerror:"402"},"cmi.evaluation.comments.n.content":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.location":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.evaluation.comments.n.time":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_TIME,mod:"rw",writeerror:"405"},"cmi.comments_from_lms":{mod:"r",writeerror:"403"},"cmi.objectives._children":{defaultvalue:this.OBJECTIVES_CHILDREN,mod:"r",writeerror:"402"},"cmi.objectives._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.objectives.n.id":{pattern:this.CMI_INDEX,format:this.CMI_IDENTIFIER,mod:"rw",writeerror:"405"},"cmi.objectives.n.score._children":{pattern:this.CMI_INDEX,mod:"r",writeerror:"402"},"cmi.objectives.n.score.raw":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.min":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.objectives.n.score.max":{defaultvalue:"",pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.SCORE_RANGE,mod:"rw",writeerror:"405"},"cmi.objectives.n.status":{pattern:this.CMI_INDEX,format:this.CMI_STATUS_2,mod:"rw",writeerror:"405"},"cmi.student_data._children":{defaultvalue:this.STUDENT_DATA_CHILDREN,mod:"r",writeerror:"402"},"cmi.student_data.mastery_score":{defaultvalue:this.def[e]["cmi.student_data.mastery_score"],mod:"r",writeerror:"403"},"cmi.student_data.max_time_allowed":{defaultvalue:this.def[e]["cmi.student_data.max_time_allowed"],mod:"r",writeerror:"403"},"cmi.student_data.time_limit_action":{defaultvalue:this.def[e]["cmi.student_data.time_limit_action"],mod:"r",writeerror:"403"},"cmi.student_preference._children":{defaultvalue:this.STUDENT_PREFERENCE_CHILDREN,mod:"r",writeerror:"402"},"cmi.student_preference.audio":{defaultvalue:this.def[e]["cmi.student_preference.audio"],format:this.CMI_SINTEGER,range:this.AUDIO_RANGE,mod:"rw",writeerror:"405"},"cmi.student_preference.language":{defaultvalue:this.def[e]["cmi.student_preference.language"],format:this.CMI_STRING_256,mod:"rw",writeerror:"405"},"cmi.student_preference.speed":{defaultvalue:this.def[e]["cmi.student_preference.speed"],format:this.CMI_SINTEGER,range:this.SPEED_RANGE,mod:"rw",writeerror:"405"},"cmi.student_preference.text":{defaultvalue:this.def[e]["cmi.student_preference.text"],format:this.CMI_SINTEGER,range:this.TEXT_RANGE,mod:"rw",writeerror:"405"},"cmi.interactions._children":{defaultvalue:this.INTERACTIONS_CHILDREN,mod:"r",writeerror:"402"},"cmi.interactions._count":{mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.id":{pattern:this.CMI_INDEX,format:this.CMI_IDENTIFIER,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.objectives._count":{pattern:this.CMI_INDEX,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.objectives.n.id":{pattern:this.CMI_INDEX,format:this.CMI_IDENTIFIER,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.time":{pattern:this.CMI_INDEX,format:this.CMI_TIME,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.type":{pattern:this.CMI_INDEX,format:this.CMI_TYPE,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.correct_responses._count":{pattern:this.CMI_INDEX,mod:"r",defaultvalue:"0",writeerror:"402"},"cmi.interactions.n.correct_responses.n.pattern":{pattern:this.CMI_INDEX,format:this.CMI_FEEDBACK,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.weighting":{pattern:this.CMI_INDEX,format:this.CMI_DECIMAL,range:this.WEIGHTING_RANGE,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.student_response":{pattern:this.CMI_INDEX,format:this.CMI_FEEDBACK,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.result":{pattern:this.CMI_INDEX,format:this.CMI_RESULT,mod:"w",readerror:"404",writeerror:"405"},"cmi.interactions.n.latency":{pattern:this.CMI_INDEX,format:this.CMI_TIMESPAN,mod:"w",readerror:"404",writeerror:"405"},"nav.event":{defaultvalue:"",format:this.NAV_EVENT,mod:"w",readerror:"404",writeerror:"405"}},this.currentUserData[e]={};for(var i in this.dataModel[e])null===i.match(/\.n\./)&&void 0!==this.dataModel[e][i].defaultvalue&&(this.currentUserData[e][i]=this.dataModel[e][i].defaultvalue);for(var i in this.def[e])null===i.match(/\.n\./)&&(this.currentUserData[e][i]=void 0!==this.dataModel[e][i].defaultvalue?this.dataModel[e][i].defaultvalue:void 0!==this.defExtra[e][i]?this.defExtra[e][i]:"");var o=new RegExp(this.CMI_INDEX,"g");for(var i in this.defExtra[e]){var s="",n=0,a=void 0,c=void 0;i.match(o)&&(a=i.replace(o,".$1."),this.currentUserData[e][a]=this.defExtra[e][i],0===a.indexOf("cmi.evaluation.comments")?(s="cmi.evaluation.comments._count",n=a.match(/.(\d+)./)[1]):0===a.indexOf("cmi.objectives")?(s="cmi.objectives._count",n=a.match(/.(\d+)./)[1]):0===a.indexOf("cmi.interactions")&&(a.indexOf(".objectives.")>0?(c=a.match(/cmi.interactions.(\d+)./)[1],n=a.match(/objectives.(\d+)./)[1],s="cmi.interactions."+c+".objectives._count"):a.indexOf(".correct_responses.")>0?(c=a.match(/cmi.interactions.(\d+)./)[1],n=a.match(/correct_responses.(\d+)./)[1],s="cmi.interactions."+c+".correct_responses._count"):(s="cmi.interactions._count",n=a.match(/.(\d+)./)[1])),s&&(void 0===this.currentUserData[e][s]&&(this.currentUserData[e][s]=0),parseInt(n)==parseInt(this.currentUserData[e][s])&&(this.currentUserData[e][s]=parseInt(this.currentUserData[e][s])+1),parseInt(n)>parseInt(this.currentUserData[e][s])&&(this.currentUserData[e][s]=parseInt(n)-1)))}""===this.currentUserData[e]["cmi.core.lesson_status"]&&(this.currentUserData[e]["cmi.core.lesson_status"]="not attempted"),this.currentUserData[e]["cmi.core.credit"]=this.mode==E.a.MODENORMAL?"credit":"no-credit",this.currentUserData[e]["cmi.core.lesson_mode"]=this.mode}},t.prototype.LMSCommit=function(t){if(this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.errorCode="0",""==t){if(this.initialized){var e=this.storeData(!1);return this.triggerEvent(E.a.UPDATE_TOC_EVENT),this.errorCode=e?"0":"101",e?"true":"false"}this.errorCode="301"}else this.errorCode="201";return"false"},t.prototype.LMSFinish=function(t){if(this.errorCode="0",""==t){if(this.initialized){this.initialized=!1;var e=this.storeData(!0);return""!=this.getEl("nav.event")?"continue"==this.getEl("nav.event")?this.triggerEvent(E.a.LAUNCH_NEXT_SCO_EVENT):this.triggerEvent(E.a.LAUNCH_PREV_SCO_EVENT):"1"==this.scorm.auto&&this.triggerEvent(E.a.LAUNCH_NEXT_SCO_EVENT),this.errorCode=e?"0":"101",this.triggerEvent(E.a.UPDATE_TOC_EVENT),e?"true":"false"}this.errorCode="301"}else this.errorCode="201";return"false"},t.prototype.LMSGetDiagnostic=function(t){return""==t&&(t=this.errorCode),t},t.prototype.LMSGetErrorString=function(t){return""!=t?this.ERROR_STRINGS[t]:""},t.prototype.LMSGetLastError=function(){return this.errorCode},t.prototype.LMSGetValue=function(t){if(this.errorCode="0",this.initialized)if(""!=t){var e=new RegExp(this.CMI_INDEX,"g"),r=String(t).replace(e,".n.");if(void 0!==this.dataModel[this.scoId][r]){if("w"!=this.dataModel[this.scoId][r].mod)return this.errorCode="0",this.getEl(t);this.errorCode=this.dataModel[this.scoId][r].readerror}else{if("._children"==r.substr(r.length-"._children".length,r.length)){var i=r.substr(0,r.length-"._children".length);this.errorCode=void 0!==this.dataModel[this.scoId][i]?"202":"201"}else if("._count"==r.substr(r.length-"._count".length,r.length)){i=r.substr(0,r.length-"._count".length);this.errorCode=void 0!==this.dataModel[this.scoId][i]?"203":"201"}else this.errorCode="201"}}else this.errorCode="201";else this.errorCode="301";return""},t.prototype.LMSInitialize=function(t){if(this.errorCode="0",""==t){if(!this.initialized)return this.initialized=!0,this.errorCode="0","true";this.errorCode="101"}else this.errorCode="201";return"false"},t.prototype.LMSSetValue=function(t,e){if(this.errorCode="0",this.initialized)if(""!=t){var r=new RegExp(this.CMI_INDEX,"g"),i=String(t).replace(r,".n.");if(void 0!==this.dataModel[this.scoId][i])if("r"!=this.dataModel[this.scoId][i].mod){r=new RegExp(this.dataModel[this.scoId][i].format);if(null!=(e+="").match(r)){if(t!=i){if(0===t.indexOf("cmi.objectives")){var o=t.match(/cmi.objectives.(\d+)./)[1];void 0===this.currentUserData[this.scoId][(l="cmi.objectives."+o+".score")+"._children"]&&(this.setEl(this.currentUserData[this.scoId][l+"._children"],this.SCORE_CHILDREN),this.setEl(this.currentUserData[this.scoId][l+".raw"],""),this.setEl(this.currentUserData[this.scoId][l+".min"],""),this.setEl(this.currentUserData[this.scoId][l+".max"],""))}else if(0===t.indexOf("cmi.interactions")){o=t.match(/cmi.interactions.(\d+)./)[1];void 0===this.currentUserData[this.scoId][l="cmi.interactions."+o+".objectives._count"]&&this.setEl(l,0),void 0===this.currentUserData[this.scoId][l="cmi.interactions."+o+".correct_responses._count"]&&this.setEl(l,0)}for(var s=t.split("."),n="cmi",a=1;a<s.length-1;a++){var c=s[a];if(s[a+1].match(/^\d+$/)){var l;if(void 0===this.currentUserData[this.scoId][l=n+"."+c+"._count"]&&this.setEl(l,0),s[a+1]==this.getEl(l)){var d=this.getEl(l);this.setEl(l,parseInt(d,10)+1)}s[a+1]>this.getEl(l)&&(this.errorCode="201"),n=n.concat("."+c+"."+s[a+1]),a++}else n=n.concat("."+c)}t=n.concat("."+s[s.length-1])}if("0"==this.errorCode){if(this.scorm.autocommit&&!this.timeout&&(this.timeout=setTimeout(this.LMSCommit.bind(this),6e4,[""])),void 0===this.dataModel[this.scoId][i].range)return"cmi.comments"==t?this.setEl("cmi.comments",this.getEl("cmi.comments")+e):this.setEl(t,e),this.errorCode="0","true";var h=this.dataModel[this.scoId][i].range.split("#");if((e*=1)>=h[0]&&e<=h[1])return this.setEl(t,e),this.errorCode="0","true";this.errorCode=this.dataModel[this.scoId][i].writeerror}}else this.errorCode=this.dataModel[this.scoId][i].writeerror}else this.errorCode=this.dataModel[this.scoId][i].writeerror;else this.errorCode="201"}else this.errorCode="201";else this.errorCode="301";return"false"},t.prototype.loadSco=function(t){this.scoId=t},t.prototype.setEl=function(t,e){void 0===this.currentUserData[this.scoId]&&(this.currentUserData[this.scoId]={}),this.currentUserData[this.scoId][t]=e},t.prototype.setOffline=function(t){this.offline=t},t.prototype.storeData=function(t){var e;t?("not attempted"==this.getEl("cmi.core.lesson_status")&&this.setEl("cmi.core.lesson_status","completed"),this.getEl("cmi.core.lesson_mode")==E.a.MODENORMAL&&"credit"==this.getEl("cmi.core.credit")&&""!==this.getEl("cmi.student_data.mastery_score")&&""!==this.getEl("cmi.core.score.raw")&&(parseFloat(this.getEl("cmi.core.score.raw"))>=parseFloat(this.getEl("cmi.student_data.mastery_score"))?this.setEl("cmi.core.lesson_status","passed"):this.setEl("cmi.core.lesson_status","failed")),this.getEl("cmi.core.lesson_mode")==E.a.MODEBROWSE&&""==this.dataModel[this.scoId]["cmi.core.lesson_status"].defaultvalue&&"not attempted"==this.getEl("cmi.core.lesson_status")&&this.setEl("cmi.core.lesson_status","browsed"),(e=this.collectData()).push(this.totalTime())):e=this.collectData();var r=this.scormProvider.saveTracksSync(this.scoId,this.attempt,e,this.scorm,this.offline,this.currentUserData);return this.offline||r?r:(this.offline=!0,this.triggerEvent(E.a.GO_OFFLINE_EVENT),this.scormProvider.saveTracksSync(this.scoId,this.attempt,e,this.scorm,this.offline,this.currentUserData))},t.prototype.totalTime=function(){return{element:"cmi.core.total_time",value:this.addTime(this.getEl("cmi.core.total_time"),this.getEl("cmi.core.session_time"))}},t.prototype.triggerEvent=function(t){this.eventsProvider.trigger(t,{scormId:this.scorm.id,scoId:this.scoId,attempt:this.attempt},this.siteId)},t}(),w=this&&this.__decorate||function(t,e,r,i){var o,s=arguments.length,n=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n},N=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},T=function(){function t(t,e,r,i,o,s,n,a,c,l,d){this.modalCtrl=e,this.eventsProvider=r,this.sitesProvider=i,this.syncProvider=o,this.domUtils=s,this.timeUtils=n,this.scormProvider=a,this.scormHelper=c,this.scormSyncProvider=l,this.tabs=d,this.loadingToc=!0,this.offline=!1,this.scorm=t.get("scorm")||{},this.mode=t.get("mode")||E.a.MODENORMAL,this.newAttempt=!!t.get("newAttempt"),this.organizationId=t.get("organizationId"),this.initialScoId=t.get("scoId"),this.siteId=this.sitesProvider.getCurrentSiteId(),this.title=this.scorm.name,this.syncProvider.blockOperation(E.a.COMPONENT,this.scorm.id,"player")}return t.prototype.ngOnInit=function(){var t=this;this.showToc=this.scormProvider.displayTocInPlayer(this.scorm),this.scorm.popup&&(this.tabs.changeVisibility(!1),this.scorm.width<=100&&(this.scorm.width=this.scorm.width+"%"),this.scorm.height<=100&&(this.scorm.height=this.scorm.height+"%")),this.fetchData().then(function(){if(t.currentSco){return(t.newAttempt?t.setStartTime(t.currentSco.id):Promise.resolve()).catch(function(e){t.domUtils.showErrorModalDefault(e,"addon.mod_scorm.errorgetscorm",!0)}).finally(function(){t.loadSco(t.currentSco)})}}).finally(function(){t.loaded=!0}),this.tocObserver=this.eventsProvider.on(E.a.UPDATE_TOC_EVENT,function(e){e.scormId===t.scorm.id&&(t.offline?setTimeout(t.refreshToc.bind(t),100):t.refreshToc())},this.siteId),this.launchNextObserver=this.eventsProvider.on(E.a.LAUNCH_NEXT_SCO_EVENT,function(e){e.scormId===t.scorm.id&&t.nextSco&&t.loadSco(t.nextSco)},this.siteId),this.launchPrevObserver=this.eventsProvider.on(E.a.LAUNCH_PREV_SCO_EVENT,function(e){e.scormId===t.scorm.id&&t.previousSco&&t.loadSco(t.previousSco)},this.siteId),this.goOfflineObserver=this.eventsProvider.on(E.a.GO_OFFLINE_EVENT,function(e){e.scormId!==t.scorm.id||t.offline||(t.offline=!0,setTimeout(function(){t.scormHelper.convertAttemptToOffline(t.scorm,t.attempt).catch(function(e){t.domUtils.showErrorModalDefault(e,"core.error",!0)}).then(function(){t.refreshToc()})},200))},this.siteId)},t.prototype.calculateNextAndPreviousSco=function(t){this.previousSco=this.scormHelper.getPreviousScoFromToc(this.toc,t),this.nextSco=this.scormHelper.getNextScoFromToc(this.toc,t)},t.prototype.determineAttemptAndMode=function(t){var e,r=this;return this.scormHelper.determineAttemptToContinue(this.scorm,t).then(function(e){return r.attempt=e.number,r.offline=e.offline,r.attempt!=t.lastAttempt.number&&(r.attemptToContinue=r.attempt),r.attempt>0&&r.scormProvider.isAttemptIncomplete(r.scorm.id,r.attempt,r.offline)}).then(function(i){if((e=r.scormProvider.determineAttemptAndMode(r.scorm,r.mode,r.attempt,r.newAttempt,i)).attempt>r.attempt)return r.offline?r.scormHelper.createOfflineAttempt(r.scorm,e.attempt,t.online.length):r.scormProvider.getScormUserData(r.scorm.id,e.attempt,void 0,!1,!0).catch(function(){return r.offline=!0,r.scormHelper.createOfflineAttempt(r.scorm,e.attempt,t.online.length)})}).then(function(){r.mode=e.mode,r.newAttempt=e.newAttempt,r.attempt=e.attempt})},t.prototype.fetchData=function(){var t=this;return this.scormSyncProvider.waitForSync(this.scorm.id).then(function(){return t.scormProvider.getAttemptCount(t.scorm.id).then(function(e){return t.determineAttemptAndMode(e).then(function(){var e=[];return e.push(t.fetchToc()),e.push(t.scormProvider.getScormUserData(t.scorm.id,t.attempt,void 0,t.offline).then(function(e){t.userData=e})),Promise.all(e)})}).catch(function(e){t.domUtils.showErrorModalDefault(e,"addon.mod_scorm.errorgetscorm",!0)})})},t.prototype.fetchToc=function(){var t=this;return this.loadingToc=!0,this.scormProvider.isAttemptIncomplete(this.scorm.id,this.attempt,this.offline).then(function(e){return t.scorm.incomplete=e,t.scormProvider.getOrganizationToc(t.scorm.id,t.attempt,t.organizationId,t.offline)}).then(function(e){if(t.toc=t.scormProvider.formatTocToArray(e),t.toc.forEach(function(e){e.image=t.scormProvider.getScoStatusIcon(e,t.scorm.incomplete)}),t.initialScoId>0&&(t.currentSco=t.scormHelper.getScoFromToc(t.toc,t.initialScoId)),!t.currentSco)return t.scormHelper.getFirstSco(t.scorm.id,t.attempt,t.toc,t.organizationId,t.offline).then(function(e){e?t.currentSco=e:t.errorMessage="addon.mod_scorm.errornovalidsco"})}).finally(function(){t.loadingToc=!1})},t.prototype.ionViewWillUnload=function(){this.src=""},t.prototype.loadSco=function(t){var e=this;if(this.dataModel?this.dataModel.loadSco(t.id):(this.dataModel=new M(this.eventsProvider,this.scormProvider,this.siteId,this.scorm,t.id,this.attempt,this.userData,this.mode,this.offline),window.API=this.dataModel),this.currentSco=t,this.title=t.title||this.scorm.name,this.calculateNextAndPreviousSco(t.id),this.scormProvider.getScoSrc(this.scorm,t).then(function(t){t==e.src?(e.src="",setTimeout(function(){e.src=t})):e.src=t}),"asset"==t.scormtype){var r=[{element:"cmi.core.lesson_status",value:"completed"}];this.scormProvider.saveTracks(t.id,this.attempt,r,this.scorm,this.offline).catch(function(){if(!e.offline)return e.scormProvider.getScormUserData(e.scorm.id,e.attempt,void 0,!1).then(function(i){if(!i[t.id]||"completed"!=i[t.id].userdata["cmi.core.lesson_status"])return e.scormHelper.convertAttemptToOffline(e.scorm,e.attempt).then(function(){return e.offline=!0,e.dataModel.setOffline(!0),e.scormProvider.saveTracks(t.id,e.attempt,r,e.scorm,!0)}).catch(function(t){e.domUtils.showErrorModalDefault(t,"core.error",!0)})})}).then(function(){e.refreshToc()})}this.scormProvider.logLaunchSco(this.scorm.id,t.id).catch(function(){})},t.prototype.openToc=function(t){var e=this,r=this.modalCtrl.create("AddonModScormTocPage",{toc:this.toc,attemptToContinue:this.attemptToContinue,mode:this.mode,selected:this.currentSco&&this.currentSco.id},{cssClass:"core-modal-lateral",showBackdrop:!0,enableBackdropDismiss:!0,enterAnimation:"core-modal-lateral-transition",leaveAnimation:"core-modal-lateral-transition"});r.onDidDismiss(function(t){t&&e.loadSco(t)}),r.present({ev:t})},t.prototype.refreshToc=function(){var t=this;return this.scormProvider.invalidateAllScormData(this.scorm.id).catch(function(){}).then(function(){return t.fetchToc()}).catch(function(e){t.domUtils.showErrorModalDefault(e,"addon.mod_scorm.errorgetscorm",!0)})},t.prototype.setStartTime=function(t){var e=this,r=[{element:"x.start.time",value:this.timeUtils.timestamp()}];return this.scormProvider.saveTracks(t,this.attempt,r,this.scorm,this.offline).then(function(){e.offline||e.scormProvider.getAttemptCount(e.scorm.id,!1,!0).catch(function(){})})},t.prototype.ngOnDestroy=function(){var t=this;this.tocObserver&&this.tocObserver.off(),this.launchNextObserver&&this.launchNextObserver.off(),this.launchPrevObserver&&this.launchPrevObserver.off(),setTimeout(function(){t.goOfflineObserver&&t.goOfflineObserver.off()},500),this.syncProvider.unblockOperation(E.a.COMPONENT,this.scorm.id,"player"),this.tabs.changeVisibility(!0)},t=w([Object(c.m)({selector:"page-addon-mod-scorm-player",templateUrl:"player.html"}),N("design:paramtypes",[l.t,l.q,m.a,f.a,_.a,p.a,v.a,E.a,C.a,g.a,I.a])],t)}(),D=this&&this.__decorate||function(t,e,r,i){var o,s=arguments.length,n=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(n=(s<3?o(n):s>3?o(e,r,n):o(e,r))||n);return s>3&&n&&Object.defineProperty(e,r,n),n},S=function(){function t(){}return t=D([Object(c.I)({declarations:[T],imports:[h.a,u.a,l.l.forChild(T),d.b.forChild()]})],t)}(),b=r(1365),R=r(1366),O=r(1367),y=r(1368),A=r(1369),P=r(1370),U=r(1371),x=r(1372),L=r(1373),G=r(1376),$=r(1377),j=r(1378),H=r(46),X=r(43),V=r(6),F=r(27),k=r(18),z=r(45),B=r(117),W=r(97),K=r(364),J=r(264),q=r(5),Y=r(36),Q=r(75),Z=r(447),tt=r(37),et=r(1374),rt=r(207),it=r(32),ot=r(21),st=r(676),nt=r(14),at=r(1375),ct=r(350),lt=r(253),dt=r(41),ht=r(10),ut=r(2),mt=r(26),ft=r(16),_t=r(9),pt=r(17),vt=r(25),It=r(34),Et=r(448),Ct=r(7),gt=r(178),Mt=r(31),wt=r(104),Nt=r(49),Tt=r(48),Dt=r(721),St=r(371),bt=r(63),Rt=r(181),Ot=c._29({encapsulation:2,styles:[],data:{}}),yt=c._27("page-addon-mod-scorm-player",T,function(t){return c._57(0,[(t()(),c._31(0,0,null,null,1,"page-addon-mod-scorm-player",[],null,null,null,a,Ot)),c._30(1,245760,null,0,T,[bt.a,Rt.a,m.a,f.a,_.a,p.a,v.a,E.a,C.a,g.a,I.a],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]),At=r(22),Pt=r(346),Ut=r(347),xt=r(349),Lt=r(348),Gt=r(446),$t=r(675),jt=r(103),Ht=r(254);r.d(e,"AddonModScormPlayerPageModuleNgFactory",function(){return Xt});var Xt=c._28(S,[],function(t){return c._40([c._41(512,c.o,c._21,[[8,[b.a,R.a,O.a,y.a,A.a,P.a,U.a,x.a,L.a,G.a,$.a,j.a,yt]],[3,c.o],c.K]),c._41(4608,Ct.m,Ct.l,[c.G,[2,Ct.v]]),c._41(4608,At.x,At.x,[]),c._41(4608,At.d,At.d,[]),c._41(4608,Pt.b,Pt.a,[]),c._41(4608,Ut.a,Ut.b,[]),c._41(4608,xt.b,xt.a,[]),c._41(4608,Lt.b,Lt.a,[]),c._41(4608,k.a,k.a,[Gt.a,Pt.b,Ut.a,xt.b,Lt.b,k.b,k.c]),c._41(512,Ct.b,Ct.b,[]),c._41(512,At.v,At.v,[]),c._41(512,At.i,At.i,[]),c._41(512,At.s,At.s,[]),c._41(512,$t.a,$t.a,[]),c._41(512,d.b,d.b,[]),c._41(512,u.a,u.a,[]),c._41(512,jt.a,jt.a,[]),c._41(512,h.a,h.a,[]),c._41(512,$t.b,$t.b,[]),c._41(512,S,S,[]),c._41(256,k.c,void 0,[]),c._41(256,k.b,void 0,[]),c._41(256,Ht.a,T,[])])})}});