webpackJsonp([36],{1938:function(l,e,n){"use strict";function t(l){return u._57(0,[(l()(),u._31(0,0,null,null,25,"ion-item",[["class","item item-block"]],[[2,"core-primary-selected-item",null]],null,null,w.b,w.a)),u._30(1,1097728,null,3,I.a,[N.a,T.a,u.t,u.V,[2,$.a]],null,null),u._52(335544320,1,{contentLabel:0}),u._52(603979776,2,{_buttons:1}),u._52(603979776,3,{_icons:1}),u._30(5,16384,null,0,C.a,[],null,null),(l()(),u._55(-1,2,["\n            "])),(l()(),u._31(7,0,null,2,2,"h2",[],null,null,null,null,null)),(l()(),u._31(8,0,null,null,1,"core-format-text",[],null,null,null,null,null)),u._30(9,540672,null,0,E.a,[u.t,c.a,f.a,_.a,M.a,z.a,A.a,G.a,J.a,s.a,r.a,K.a,[2,q.a],[2,B.a],[2,H.a],Q.a,W.a],{text:[0,"text"]},null),(l()(),u._55(-1,2,["\n            "])),(l()(),u._31(11,0,null,2,1,"p",[],null,null,null,null,null)),(l()(),u._55(12,null,["",""])),(l()(),u._55(-1,2,["\n            "])),(l()(),u._31(14,0,null,4,2,"p",[["item-end",""]],null,null,null,null,null)),(l()(),u._55(15,null,["",""])),u._49(16,1),(l()(),u._55(-1,2,["\n            "])),(l()(),u._31(18,0,null,4,6,"button",[["clear",""],["color","danger"],["icon-only",""],["ion-button",""],["item-end",""]],[[8,"hidden",0],[1,"aria-label",0]],[[null,"click"]],function(l,e,n){var t=!0;if("click"===e){t=!1!==l.component.deleteSiteFiles(l.context.$implicit)&&t}return t},X.b,X.a)),u._30(19,1097728,[[2,4]],0,Y.a,[[8,""],T.a,u.t,u.V],{color:[0,"color"],clear:[1,"clear"]},null),u._47(131072,Z.a,[M.a,u.j]),(l()(),u._55(-1,0,["\n                "])),(l()(),u._31(22,0,null,0,1,"ion-icon",[["name","trash"],["role","img"]],[[2,"hide",null]],null,null,null,null)),u._30(23,147456,null,0,ll.a,[T.a,u.t,u.V],{name:[0,"name"]},null),(l()(),u._55(-1,0,["\n            "])),(l()(),u._55(-1,2,["\n        "]))],function(l,e){l(e,9,0,e.context.$implicit.siteName);l(e,19,0,"danger","");l(e,23,0,"trash")},function(l,e){l(e,0,0,e.context.$implicit.id==e.component.currentSiteId);l(e,12,0,e.context.$implicit.fullName);l(e,15,0,u._56(e,15,0,l(e,16,0,u._44(e.parent,0),e.context.$implicit.spaceUsage)));l(e,18,0,!e.context.$implicit.spaceUsage>"0",u._56(e,18,1,u._44(e,20).transform("core.settings.deletesitefilestitle")));l(e,22,0,u._44(e,23)._hidden)})}function a(l){return u._57(0,[u._47(0,el.a,[J.a,_.a]),(l()(),u._31(1,0,null,null,12,"ion-header",[],null,null,null,null,null)),u._30(2,16384,null,0,nl.a,[T.a,u.t,u.V,[2,tl.a]],null,null),(l()(),u._55(-1,null,["\n    "])),(l()(),u._31(4,0,null,null,8,"ion-navbar",[["class","toolbar"],["core-back-button",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,al.b,al.a)),u._30(5,49152,null,0,ul.a,[il.a,[2,tl.a],[2,q.a],T.a,u.t,u.V],null,null),u._30(6,212992,null,0,ol.a,[ul.a,z.a,M.a,W.a],null,null),(l()(),u._55(-1,3,["\n        "])),(l()(),u._31(8,0,null,3,3,"ion-title",[],null,null,null,rl.b,rl.a)),u._30(9,49152,null,0,sl.a,[T.a,u.t,u.V,[2,cl.a],[2,ul.a]],null,null),(l()(),u._55(10,0,["",""])),u._47(131072,Z.a,[M.a,u.j]),(l()(),u._55(-1,3,["\n    "])),(l()(),u._55(-1,null,["\n"])),(l()(),u._55(-1,null,["\n"])),(l()(),u._31(15,0,null,null,33,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,_l.b,_l.a)),u._30(16,4374528,null,0,B.a,[T.a,z.a,fl.a,u.t,u.V,il.a,dl.a,u.M,[2,tl.a],[2,q.a]],null,null),(l()(),u._55(-1,1,["\n    "])),(l()(),u._31(18,0,null,2,6,"ion-refresher",[],[[2,"refresher-active",null],[4,"top",null]],[[null,"ionRefresh"]],function(l,e,n){var t=!0;if("ionRefresh"===e){t=!1!==l.component.refreshData(n)&&t}return t},null,null)),u._30(19,212992,null,0,pl.a,[z.a,B.a,u.M,hl.l],{enabled:[0,"enabled"]},{ionRefresh:"ionRefresh"}),(l()(),u._55(-1,null,["\n        "])),(l()(),u._31(21,0,null,null,2,"ion-refresher-content",[],[[1,"state",0]],null,null,gl.b,gl.a)),u._30(22,114688,null,0,bl.a,[pl.a,T.a],{pullingText:[0,"pullingText"]},null),u._47(131072,Z.a,[M.a,u.j]),(l()(),u._55(-1,null,["\n    "])),(l()(),u._55(-1,1,["\n    "])),(l()(),u._31(26,0,null,1,21,"core-loading",[],null,null,null,ml.b,ml.a)),u._30(27,638976,null,0,vl.a,[M.a,u.t,W.a,A.a],{hideUntil:[0,"hideUntil"]},null),(l()(),u._55(-1,0,["\n        "])),(l()(),u._26(16777216,null,0,1,null,t)),u._30(30,802816,null,0,Ul.j,[u._11,u._6,u.E],{ngForOf:[0,"ngForOf"]},null),(l()(),u._55(-1,0,["\n        "])),(l()(),u._31(32,0,null,0,14,"ion-item-divider",[["class","item item-divider"]],null,null,null,w.b,w.a)),u._30(33,1097728,null,3,I.a,[N.a,T.a,u.t,u.V,[2,$.a]],null,null),u._52(335544320,4,{contentLabel:0}),u._52(603979776,5,{_buttons:1}),u._52(603979776,6,{_icons:1}),u._30(37,16384,null,0,yl.a,[T.a,u.t,u.V],null,null),(l()(),u._55(-1,2,["\n            "])),(l()(),u._31(39,0,null,2,2,"p",[],null,null,null,null,null)),(l()(),u._55(40,null,["",""])),u._47(131072,Z.a,[M.a,u.j]),(l()(),u._55(-1,2,["\n            "])),(l()(),u._31(43,0,null,4,2,"p",[["item-end",""]],null,null,null,null,null)),(l()(),u._55(44,null,["",""])),u._49(45,1),(l()(),u._55(-1,2,["\n        "])),(l()(),u._55(-1,0,["\n    "])),(l()(),u._55(-1,1,["\n"])),(l()(),u._55(-1,null,["\n"]))],function(l,e){var n=e.component;l(e,6,0);l(e,19,0,n.usageLoaded);l(e,22,0,u._34(1,"",u._56(e,22,0,u._44(e,23).transform("core.pulltorefresh")),""));l(e,27,0,n.usageLoaded);l(e,30,0,n.sites)},function(l,e){var n=e.component;l(e,4,0,u._44(e,5)._hidden,u._44(e,5)._sbPadding);l(e,10,0,u._56(e,10,0,u._44(e,11).transform("core.settings.spaceusage")));l(e,15,0,u._44(e,16).statusbarPadding,u._44(e,16)._hasRefresher);l(e,18,0,"inactive"!==u._44(e,19).state,u._44(e,19)._top);l(e,21,0,u._44(e,22).r.state);l(e,40,0,u._56(e,40,0,u._44(e,41).transform("core.settings.total")));l(e,44,0,u._56(e,44,0,l(e,45,0,u._44(e,0),n.totalUsage)))})}Object.defineProperty(e,"__esModule",{value:!0});var u=n(0),i=n(8),o=n(3),r=n(9),s=n(16),c=n(1),_=n(10),f=n(4),d=this&&this.__decorate||function(l,e,n,t){var a,u=arguments.length,i=u<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(l,e,n,t);else for(var o=l.length-1;o>=0;o--)(a=l[o])&&(i=(u<3?a(i):u>3?a(e,n,i):a(e,n))||i);return u>3&&i&&Object.defineProperty(e,n,i),i},p=this&&this.__metadata||function(l,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(l,e)},h=function(){function l(l,e,n,t,a,u){this.filePoolProvider=l,this.sitesProvider=e,this.textUtils=n,this.translate=t,this.domUtils=a,this.usageLoaded=!1,this.sites=[],this.currentSiteId="",this.totalUsage=0,this.currentSiteId=this.sitesProvider.getCurrentSiteId()}return l.prototype.ionViewDidLoad=function(){var l=this;this.fetchData().finally(function(){l.usageLoaded=!0})},l.prototype.calculateSizeUsage=function(){var l=this;return this.sitesProvider.getSortedSites().then(function(e){l.sites=e;var n=l.sites.map(function(e){return l.sitesProvider.getSite(e.id).then(function(l){return l.getSpaceUsage().then(function(l){e.spaceUsage=l})})});return Promise.all(n)})},l.prototype.calculateTotalUsage=function(){var l=0;this.sites.forEach(function(e){e.spaceUsage&&(l+=parseInt(e.spaceUsage,10))}),this.totalUsage=l},l.prototype.fetchData=function(){var l=this,e=[this.calculateSizeUsage().then(function(){return l.calculateTotalUsage()})];return Promise.all(e)},l.prototype.refreshData=function(l){this.fetchData().finally(function(){l.complete()})},l.prototype.updateSiteUsage=function(l,e){var n=l.spaceUsage;l.spaceUsage=e,this.totalUsage-=n-e},l.prototype.deleteSiteFiles=function(l){var e=this;this.textUtils.formatText(l.siteName).then(function(n){var t=e.translate.instant("core.settings.deletesitefilestitle"),a=e.translate.instant("core.settings.deletesitefiles",{sitename:n});e.domUtils.showConfirm(a,t).then(function(){return e.sitesProvider.getSite(l.id)}).then(function(n){n.deleteFolder().then(function(){e.filePoolProvider.clearAllPackagesStatus(n.id),e.filePoolProvider.clearFilepool(n.id),e.updateSiteUsage(l,0)}).catch(function(t){t&&t.code===FileError.NOT_FOUND_ERR?(e.filePoolProvider.clearAllPackagesStatus(n.id),e.updateSiteUsage(l,0)):(e.domUtils.showErrorModal("core.settings.errordeletesitefiles",!0),n.getSpaceUsage().then(function(n){e.updateSiteUsage(l,n)}))})}).catch(function(){})})},l=d([Object(u.m)({selector:"page-core-settings-space-usage",templateUrl:"space-usage.html"}),p("design:paramtypes",[s.a,c.a,_.a,o.c,f.a,r.a])],l)}(),g=n(24),b=n(29),m=n(103),v=this&&this.__decorate||function(l,e,n,t){var a,u=arguments.length,i=u<3?e:null===t?t=Object.getOwnPropertyDescriptor(e,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(l,e,n,t);else for(var o=l.length-1;o>=0;o--)(a=l[o])&&(i=(u<3?a(i):u>3?a(e,n,i):a(e,n))||i);return u>3&&i&&Object.defineProperty(e,n,i),i},U=function(){function l(){}return l=v([Object(u.I)({declarations:[h],imports:[g.a,b.a,m.a,i.l.forChild(h),o.b.forChild()]})],l)}(),y=n(1365),P=n(1366),S=n(1367),x=n(1368),R=n(1369),j=n(1370),O=n(1371),V=n(1372),D=n(1373),F=n(1376),k=n(1377),L=n(1378),w=n(30),I=n(20),N=n(19),T=n(6),$=n(28),C=n(33),E=n(41),M=n(18),z=n(14),A=n(2),G=n(26),J=n(5),K=n(17),q=n(22),B=n(25),H=n(34),Q=n(36),W=n(12),X=n(46),Y=n(43),Z=n(27),ll=n(45),el=n(1450),nl=n(447),tl=n(37),al=n(1374),ul=n(206),il=n(32),ol=n(676),rl=n(1375),sl=n(350),cl=n(253),_l=n(178),fl=n(31),dl=n(104),pl=n(140),hl=n(38),gl=n(194),bl=n(146),ml=n(49),vl=n(48),Ul=n(7),yl=n(111),Pl=u._29({encapsulation:2,styles:[],data:{}}),Sl=u._27("page-core-settings-space-usage",h,function(l){return u._57(0,[(l()(),u._31(0,0,null,null,1,"page-core-settings-space-usage",[],null,null,null,a,Pl)),u._30(1,49152,null,0,h,[s.a,c.a,_.a,M.a,f.a,r.a],null,null)],null,null)},{},{},[]),xl=n(21),Rl=n(346),jl=n(347),Ol=n(349),Vl=n(348),Dl=n(446),Fl=n(675),kl=n(254);n.d(e,"CoreSettingsSpaceUsagePageModuleNgFactory",function(){return Ll});var Ll=u._28(U,[],function(l){return u._40([u._41(512,u.o,u._21,[[8,[y.a,P.a,S.a,x.a,R.a,j.a,O.a,V.a,D.a,F.a,k.a,L.a,Sl]],[3,u.o],u.K]),u._41(4608,Ul.m,Ul.l,[u.G,[2,Ul.v]]),u._41(4608,xl.x,xl.x,[]),u._41(4608,xl.d,xl.d,[]),u._41(4608,Rl.b,Rl.a,[]),u._41(4608,jl.a,jl.b,[]),u._41(4608,Ol.b,Ol.a,[]),u._41(4608,Vl.b,Vl.a,[]),u._41(4608,M.a,M.a,[Dl.a,Rl.b,jl.a,Ol.b,Vl.b,M.b,M.c]),u._41(512,Ul.b,Ul.b,[]),u._41(512,xl.v,xl.v,[]),u._41(512,xl.i,xl.i,[]),u._41(512,xl.s,xl.s,[]),u._41(512,Fl.a,Fl.a,[]),u._41(512,o.b,o.b,[]),u._41(512,b.a,b.a,[]),u._41(512,m.a,m.a,[]),u._41(512,g.a,g.a,[]),u._41(512,Fl.b,Fl.b,[]),u._41(512,U,U,[]),u._41(256,M.c,void 0,[]),u._41(256,M.b,void 0,[]),u._41(256,kl.a,h,[])])})}});